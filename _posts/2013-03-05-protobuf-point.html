---
layout: point
title: CLI 
author: zzh 
thisdate: 2012-10-18
classification: linux
---
<!doctype html>  
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>YAML-CLI</title>
    <link rel="stylesheet" href="/blog/weakpoint/core/weakpoint.css">
    <script src="/blog/weakpoint/third/jquery.js" type="text/javascript"></script>
    <script src="/blog/weakpoint/third/jquery.bxSlider.min.js" type="text/javascript"></script>
    <script type="text/javascript">
  $(document).ready(function(){
    bxslide = $('#slider1').bxSlider({
        infiniteLoop: false,
        controls: false,
        mode: 'horizontal',
        speed: 200,
        onBeforeSlide: function(){onSwitch=true},
        onAfterSlide: function(){onSwitch=false}
        });
});
    </script>
     <script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [ ['$','$'], ["\(","\)"] ],processEscapes: true}});</script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']}});</script>
    <script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {var all = MathJax.Hub.getAllJax(), i;for(i=0; i < all.length; i += 1) {all[i].SourceElement().parentNode.className += ' has-jax';}});</script>
    <script type="text/javascript"src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link href='http://fonts.googleapis.com/css?family=Eater' rel='stylesheet' type='text/css'>    
    <link rel="stylesheet" href="/blog/weakpoint/theme/clean.css">
    <script type="text/javascript">var _gaq = _gaq || [];_gaq.push(['_setAccount', "UA-33272534-1"]);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
  </script>
    
  </head>
<body>
    <div class="navi"><span>由来</span><span>解读</span><span>完善</span><span>接下来</span>
    </div>
    <div id="wrapper">
    <div id="slider1">
    <div class="paper"><div class="paper-container">
<!-- ====================front page ===============  -->
<div class="title">YAML-CLI</div>
<div class="subtitle">基于yaml的自动化CLI</div>
<div class="meta"><img style="float:left;margin:15px;" class="avatar"src="/blog/weakpoint/img/ubuntu-gril.jpg" alt="avatar" width="180" height="140"/>
<table>
<tbody>
<tr class="author"><td>jack.zh</td></tr>
<tr class="social"><td><ul>
  <li class="email"><a href="mailto:git.zhang@gmail.com" targe="_blank">Email</a></li>
  <li class="sinaweibo"><a href="http://weibo.com/九月张郎" target="_blank">@sina</a></li>
  <li class="github"><a href="http://github.com/zhblog" target="_blank">Github</a></li>
</ul></td></tr>
<tr class="organization"><td>学无止境</td></tr>
<tr class="date"><td>2012-10-17</td></tr>
</tbody>
</table>
</div>
<div class="theme">clean theme</div>
 <!-- ================front page==============  -->
<div id="popup" style="margin-top: 60px;width:380px;height:120px;color: #333;display:none;background-color:#ddd;padding: 20px;border-radius: 15px;">j/k PPT翻页F11全屏</div></div></div>






    
    
    <div class="paper"><div class="paper-container">
    <!-- =========================SLIDE==========================-->
    
<h1>由来</h1>

    <!-- ====================================================== -->
    </div></div>






    
    
    <div class="paper"><div class="paper-container">
    <!-- =========================SLIDE==========================-->
    
<h2>为什么要cli</h2>
<ul>
<li>cli符合unix，linux用户使用配置习惯 </li>
<li>思科，华为等板卡的设置提供比较规范的cli设置</li>
<li>在一些系统上，cli是唯一的配置平台，不提供X和web </li>
<li>CLI的设置占用资源少，输入规范明了</li>
</ul>

    <!-- ====================================================== -->
    </div></div>






    
    
    <div class="paper"><div class="paper-container">
    <!-- =========================SLIDE==========================-->
    
<h2>cli实现的方式</h2>
<ul>
<li>据说思科华为的实现方式是C的if，else，及其庞大，形成模板，我汗</li>
<li>parser+lexer实现词法语法解析</li>
<li>其他实现方式,自己实现模板方法</li>
<li>我的实现方式<br />
</li>
<li><img alt="" src="/blog/img/w/test.png" /></li>
</ul>

    <!-- ====================================================== -->
    </div></div>






    
    
    <div class="paper"><div class="paper-container">
    <!-- =========================SLIDE==========================-->
    
<h2>为什么是yaml-cli</h2>
<ul>
<li><strong>yaml</strong>的表达能力牛逼的要死 </li>
<li><strong>json</strong>可以方便的支持web的扩展</li>
<li>readline提供了强有力的扩展API </li>
<li>C 提供了快速的，占用资源少的实现方式.</li>
<li>LUA插件也许是未来的最好是先方式.<br />
</li>
</ul>

    <!-- ====================================================== -->
    </div></div>






    
    
    <div class="paper"><div class="paper-container">
    <!-- =========================SLIDE==========================-->
    
<h1>解读</h1>

    <!-- ====================================================== -->
    </div></div>






    
    
    <div class="paper"><div class="paper-container">
    <!-- =========================SLIDE==========================-->
    
<h2>1. 代码结构</h2>
<pre><code>├── check.c
├── dispatcher.c
├── file
│   ├── CMD3.yaml
│   ├── regex
│   ├── root.yaml
├── main.c
├── re2val.c
├── readline.c
└── script
    └── write_web.py
</code></pre>

    <!-- ====================================================== -->
    </div></div>






    
    
    <div class="paper"><div class="paper-container">
    <!-- =========================SLIDE==========================-->
    
<h2>2. 增加模块</h2>
<ul>
<li>在file中新增一个yaml文件，那文件名字定义为你的模块名</li>
<li>在root.yaml中增加信的模块的部分 </li>
<li>在新的模块yaml中编写你的命令</li>
<li>编译执行测试</li>
</ul>

    <!-- ====================================================== -->
    </div></div>






    
    
    <div class="paper"><div class="paper-container">
    <!-- =========================SLIDE==========================-->
    
<h2>3. 编写模块的命令规则</h2>
<pre><code>- cmd: debug &lt;int:integer&gt;
  help: debug no help
  web: yes
  file: yes
  debug: no
  rpc: cli_set_debug_flag
</code></pre>

    <!-- ====================================================== -->
    </div></div>






    
    
    <div class="paper"><div class="paper-container">
    <!-- =========================SLIDE==========================-->
    
<h2>4. 命令解读</h2>
<pre><code>cmd:命令过规则
help：提示的字符串
web：是否支持web
file：是否支持配置导入
debug：是不是内部命令
rpc：此命令的解析函数名称
</code></pre>

    <!-- ====================================================== -->
    </div></div>






    
    
    <div class="paper"><div class="paper-container">
    <!-- =========================SLIDE==========================-->
    
<h2>5. 命令规则解读</h2>
<pre><code>&lt;&gt;:必选项，可包含其他形式
[]:可选项，可包含其他方式
{}:可重复选项，多选多
|：多选一
</code></pre>

    <!-- ====================================================== -->
    </div></div>






    
    
    <div class="paper"><div class="paper-container">
    <!-- =========================SLIDE==========================-->
    
<h1>完善</h1>

    <!-- ====================================================== -->
    </div></div>






    
    
    <div class="paper"><div class="paper-container">
    <!-- =========================SLIDE==========================-->
    
<h2>加法和减法</h2>
<ul>
<li>删除部分规则</li>
<li>增加新的规则</li>
</ul>

    <!-- ====================================================== -->
    </div></div>






    
    
    <div class="paper"><div class="paper-container">
    <!-- =========================SLIDE==========================-->
    
<h1>接下来</h1>

    <!-- ====================================================== -->
    </div></div>






    
    
    <div class="paper"><div class="paper-container">
    <!-- =========================SLIDE==========================-->
    
<h2>json的不爽</h2>
<ol>
<li>对树形结构的支持不好 </li>
<li>命令多的时候很不好处理命名问题</li>
<li>rpc的解析很是不好玩</li>
</ol>

    <!-- ====================================================== -->
    </div></div>






    
    
    <div class="paper"><div class="paper-container">
    <!-- =========================SLIDE==========================-->
    
<h2>LUA</h2>
<ul>
<li>快速，胶水</li>
<li>解释起小，可以移植</li>
<li>编写快速</li>
</ul>
    <!-- ====================================================== -->
    </div></div>
    <div class="paper"><div class="paper-container">
      <div class="thanks">Thanks!</div></div>
    </div>
    </div>
    </div>
    <script type="text/javascript" src="/blog/weakpoint/core/weakpoint.js"></script>
    <script type="text/javascript">var weakpoint = new weakPoint(); weakpoint.init();</script>
    <a href="https://github.com/zhblog"><img style="position: absolute; top: 0; right: 0; border: 0;" src="/blog/img/f.png" alt="Fork me on GitHub"></a>
    </body>
</html>
